{% extends "admin/base_site.html" %}
{% load i18n admin_modify feedmedia %}

{% block extrahead %}{{ block.super }}
<script type="text/javascript" src="{% app_static_prefix %}js/tabview.js"></script>
{% endblock %}
<body class="{% if is_popup %}popup {% endif %}{% block bodyclass %}feed-experiment change-form{% endblock %}">

{% block breadcrumbs %}{% endblock %}

{% block pretitle %}
  <div class="masthead">
    <div class="container">
      <div class="row">
        <div class="col-xs-12">
          <h1>{% if change %}Edit {{ opts.object_name}}{% else %}Add {{ opts.object_name}} - or - <button class="btn btn-primary" data-toggle="modal" data-target="#clone-modal">Clone Existing {{ opts.object_name}}</button>{% endif %}</h1>
        </div>
      </div>
      <div class="row">
        <div class="col-xs-12">
          <hr />
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block content %}
<div class="col-xs-9">
	{% block object-tools %}
	  <div class="row">
      <div class="col-xs-2 col-xs-offset-10 admin-tools">
        <ul class="object-tools object-tools-top">
          {% if change %}
            {% ifequal opts.app_label "feed" %}
            <li><a href="/admin/{{opts.app_label}}/{{ opts.object_name.lower}}/{{object_id}}/" ><span class='glyphicon glyphicon-eye-open'></span></a></li>
            {% endifequal %}
            {% if has_delete_permission %}
            <li><a href="/admin/{{opts.app_label}}/{{ opts.object_name.lower}}/{{object_id}}/delete" ><span class='glyphicon glyphicon-remove'></span></a></li>
            {% endif %}
          {% endif %}
          {% if has_change_permission %}
            {% if cloneable %}
            <li><a class="clonelink" href="/admin/{{opts.app_label}}/{{ opts.object_name.lower}}/{{object_id}}/clone" ><img src='/static/img/admin/copy-icon.png' alt='clone' title='clone'/></a></li>
            {% endif %}	
          {% endif %}	
        </ul>
      </div>
    </div>
{% endblock %}
    <form {% if has_file_field %}enctype="multipart/form-data" {% endif %}action="{{ form_url }}" method="post" id="{{ opts.module_name }}_form">
      {% csrf_token %}
      {% block form_top %}{% endblock %}
      {% if is_popup %}<input type="hidden" name="_popup" value="1" />{% endif %}
      {% if save_on_top %}<!-- {% submit_row %} -->{% endif %}
      {% if errors %}
      <div class="row">
        <div class="col-xs-11">
          <div class="messages alert alert-error">
            <p>
            {% blocktrans count errors|length as counter %}Please correct the error below.{% plural %}Please correct the errors below.{% endblocktrans %}
            </p>
            {% for error in adminform.form.non_field_errors %}<p>{{ error }}</p>{% endfor %}
          </div>
        </div>
      </div>
      {% endif %}
      <p class="required-notice"><span class="glyphicon glyphicon-asterisk"></span> Required fields</p>

      {% include "admin/feed/experiment/techniques.html" %}
      
      {% for fieldset in adminform %}
        {% include "admin/includes/fieldset.html" %}
      {% endfor %}
      
      {% block after_field_sets %}{% endblock %}
      
      {% for inline_admin_formset in inline_admin_formsets %}
        {% include inline_admin_formset.opts.template %}
      {% endfor %}
      
      {% block after_related_objects %}{% endblock %}

      <div class="row">
      {% if adminform and add %}
         <script type="text/javascript">document.getElementById("{{ adminform.first_field.auto_id }}").focus();</script>
      {% endif %}

      {# JavaScript for prepopulated fields #}
      {% prepopulated_fields_js %}
        
      {% if add %}
        <div class="col-xs-4 col-xs-offset-3">
          <input type="submit" name="_redirect_add_session" value="Next Step: Add Session">
        </div>
        <div class="col-xs-4">
          <input type="submit" value="{% trans 'Save &amp; Add Another' %}" name="_addanother" {{ onclick_attrib }} />
        </div>
        {% submit_row %}
      {% else %}
        {% include "admin/submit_line.html" %}
      {% endif %}
    </div>
  </form>
</div>
{% endblock %}

{% block sidebar %}
{% if add %}
  {% load upload_status %}
  {% upload_status_block %}
{% endif %}
{% endblock %}

{% block modal %}
<div class="modal fade" id="clone-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h3 class="modal-title">Clone Existing {{ opts.object_name}}</h3>
      </div>
      <div class="modal-body">
        <form>
          <div class="row">
            <div class="col-xs-3 col-xs-offset-1">
              <label>{{ opts.object_name}}:</label>
            </div>
            <div class="col-xs-5">
              <select class="chosen-select" single>
                <option>Existing {{ opts.object_name.lower}}</option>
                <option>Study 1</option>
              </select>
            </div>
          </div>
          <div class="modal-choices">
            <div class="row">
              <div class="col-xs-1 col-xs-offset-1">
                <input type="radio" name="optionsRadios" id="optionsRadios1" value="option1" checked>
              </div>
              <div class="col-xs-10">
                <label>Clone only {{ opts.object_name.lower}} metadata</label>
              </div>
            </div>
            <div class="row">
              <div class="col-xs-1 col-xs-offset-1">
                <input type="radio" name="optionsRadios" id="optionsRadios2" value="option2">
              </div>
              <div class="col-xs-10">
                <label>Clone all metadata</label>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-11 col-xs-offset-1">
              <div class="alert alert-info">
                <p>Cloned metadata can be modified or removed later from the Study Overview screen.</p>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <div class="row">
          <div class="col-xs-4 col-xs-offset-2">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
          <div class="col-xs-4">
            <button type="button" class="btn btn-primary">Save Changes</button>
          </div>
        </div>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<div class="modal fade" id="other-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h3 class="modal-title">Add New Sensor Type</h3>
      </div>
      <div class="modal-body">
        <form>
          <div class="row">
            <div class="col-xs-4 col-xs-offset-1">
              <label>New Sensor Name:</label>
            </div>
            <div class="col-xs-6">
              <input type="text" name="new-sensor" />
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <div class="row">
          <div class="col-xs-4 col-xs-offset-2">
            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          </div>
          <div class="col-xs-4">
            <button type="button" class="btn btn-primary">Save</button>
          </div>
        </div>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
{% endblock %}

