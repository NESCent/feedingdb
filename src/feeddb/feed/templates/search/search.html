{% extends "admin/base.html" %}
{% load i18n %}
{% load faceted_search_extras %}
{% block content %}
<html>
<head></head>
<body>
<h2>Search</h2>
<form method="get" action=".">
  <table>
    {{ form.as_table }}
    <tr>
      <td>&nbsp;</td>
      <td>
        <input type="submit" value="Search">
      </td>
    </tr>
  </table>
  {% if page or query %}
  <!-- begin faceting -->
    {# debug #}
    <div>
      <dl>
        {% if facets.fields.muscles %}
          <dt>Subclass of Muscles</dt>
          {% for muscles in facets.fields.muscles %}
            <dd><a href="{{ request.get_full_path }}&amp;selected_facets=muscles_exact:{{ muscles.0|urlencode }}">{{ muscles.0 }}</a> ({{ muscles.1 }})</dd>
          {% endfor %}
        {% else %}
          <p>No subclass muscles facets</p>
        {% endif %}
      </dl>
      <dl>
        {% if facets.fields.muscles_part_of %}
          <dt>Part of Muscles</dt>
          {% for muscles_part_of in facets.fields.muscles_part_of %}
            <dd><a href="{{ request.get_full_path }}&amp;selected_facets=muscles_part_of_exact:{{ muscles_part_of.0|urlencode }}">{{ muscles_part_of.0 }}</a> ({{ muscles_part_of.1 }})</dd>
          {% endfor %}
        {% else %}
          <p>No muscles_part_of facets</p>
        {% endif %}
      </dl>
      <dl>
        {% if facets.fields.behaviorowl_primary_ancestors %}
          <dt>Subclass of Primary Behavior</dt>
          {% for behaviorowl_primary_ancestors in facets.fields.behaviorowl_primary_ancestors %}
            <dd><a href="{{ request.get_full_path }}&amp;selected_facets=behaviorowl_primary_ancestors_exact:{{ behaviorowl_primary_ancestors.0|urlencode }}">{{ behaviorowl_primary_ancestors.0 }}</a> ({{ behaviorowl_primary_ancestors.1 }})</dd>
          {% endfor %}
        {% else %}
          <p>No subclass behaviorowl_primary_ancestors facets</p>
        {% endif %}
      </dl>
      <dl>
        {% if facets.fields.behaviorowl_primary_part_of %}
          <dt>Part of primary behavior</dt>
          {% for behaviorowl_primary_part_of in facets.fields.behaviorowl_primary_part_of %}
            <dd><a href="{{ request.get_full_path }}&amp;selected_facets=behaviorowl_primary_part_of_exact:{{ behaviorowl_primary_part_of.0|urlencode }}">{{ behaviorowl_primary_part_of.0 }}</a> ({{ behaviorowl_primary_part_of.1 }})</dd>
          {% endfor %}
        {% else %}
          <p>No behaviorowl_primary_part_of facets</p>
        {% endif %}
      </dl>
    </div>
  
    <div>
      <h4>automatic facet</h4>
      {% show_facets facet_items 'muscles' %}
    </div>
  <!-- end faceting -->
  <h3>Results</h3>
  {% for result in page.object_list %}
    <div class="result" style="border: solid black; margin: 0.5em; padding: 0.5em;">
      Muscles (direct): <br />
      <ul>
        {% for label in result.muscles_direct %}
          <li>{{ label }}</li>
        {% endfor %}
      </ul>
      Muscles (subclass expanded): <br />
      <ul>
        {% for label in result.muscles %}
          <li>{{ label }}</li>
        {% endfor %}
      </ul>
      Trial title: {{ result.object.title }}<br />
      Session title: {{ result.object.session.title }}<br />
      Experiment title: {{ result.object.session.experiment.title }}<br />
      Study title: {{ result.object.session.experiment.study.title }}<br />
    </div>
  {% empty %}
  <p>No results found.</p>
  {% endfor %}
  {% if page.has_previous or page.has_next %}
  <div>
    {% if page.has_previous %}<a href="?q={{ query }}&amp;page={{ page.previous_page_number }}">{% endif %}&laquo; Previous{% if page.has_previous %}</a>{% endif %}
    |
    {% if page.has_next %}<a href="?q={{ query }}&amp;page={{ page.next_page_number }}">{% endif %}Next &raquo;{% if page.has_next %}</a>{% endif %}
  </div>
  {% endif %}
  {% else %}
  {# Show some example queries to run, maybe query syntax, something else? #}
  {% endif %}
</form>
</body>
</html>
{% endblock content %}
